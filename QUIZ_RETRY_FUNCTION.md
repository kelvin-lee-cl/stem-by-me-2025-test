# 問卷重新答題功能實現

## 功能概述

為問卷系統添加了重新答題功能，讓用戶在答錯問卷後能夠重新嘗試，提升用戶體驗。

## 實現的功能

### 1. 重新答題按鈕
- **觸發條件**: 用戶答題分數低於60分（未通過）
- **按鈕樣式**: 黃色警告按鈕，帶有🔄圖標
- **功能**: 重置問卷答案並重新載入問卷內容

### 2. 關閉問卷按鈕
- **通過用戶**: 綠色成功按鈕，顯示"✅ 完成問卷"
- **未通過用戶**: 灰色次要按鈕，顯示"❌ 關閉問卷"
- **功能**: 關閉問卷並返回遊戲主界面

### 3. 智能結果顯示
- **通過用戶**: 綠色背景，顯示恭喜信息
- **未通過用戶**: 紅色背景，顯示鼓勵信息並提供重新答題選項

## 技術實現

### 修改的函數

#### `showQuizResults(score, correctAnswers, totalQuestions, isPassed)`
- 添加了條件渲染的按鈕區域
- 根據通過狀態顯示不同的按鈕組合
- 自動添加事件監聽器

#### `retryQuiz()`
- 重置 `quizAnswers` 對象
- 重新載入問卷內容
- 顯示提交按鈕
- 記錄重新答題事件

#### `closeQuiz()`
- 確認對話框防止誤操作
- 關閉問卷界面
- 記錄關閉事件

### 事件追蹤

系統會自動追蹤以下事件：
- `quiz_retry`: 用戶重新答題
- `quiz_closed`: 用戶關閉問卷

## 用戶體驗改進

### 1. 清晰的視覺反饋
- 不同狀態使用不同的顏色和圖標
- 按鈕樣式與Bootstrap框架一致

### 2. 直觀的操作流程
- 未通過用戶可以立即重新答題
- 通過用戶可以完成問卷並關閉

### 3. 防止誤操作
- 關閉問卷時會顯示確認對話框
- 重新答題會清空之前的答案

## 使用流程

1. **用戶選擇"難題解答挑戰"位置**
2. **系統顯示問卷**
3. **用戶答題並提交**
4. **系統評分並顯示結果**
   - 如果通過（≥60分）：顯示恭喜信息，提供"完成問卷"按鈕
   - 如果未通過（<60分）：顯示鼓勵信息，提供"重新答題"和"關閉問卷"按鈕
5. **用戶選擇操作**
   - 重新答題：清空答案，重新載入問卷
   - 關閉問卷：返回遊戲主界面

## 代碼特點

- **響應式設計**: 按鈕樣式適配不同屏幕尺寸
- **錯誤處理**: 包含完整的錯誤檢查和日誌記錄
- **事件追蹤**: 自動記錄用戶行為數據
- **模塊化**: 功能獨立，易於維護和擴展

## 未來擴展

- 可以添加答題次數限制
- 可以實現答題歷史記錄
- 可以添加提示功能
- 可以實現答題時間限制
